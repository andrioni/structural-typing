<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>structural-typing.type documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Structural-typing 0.0.1 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>structural-typing</span></div></div></li><li class="depth-2 current"><a href="structural-typing.type.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>type</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="structural-typing.type.html#var-checked"><div class="inner"><span>checked</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-coerce"><div class="inner"><span>coerce</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-coercion"><div class="inner"><span>coercion</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-coercion.21"><div class="inner"><span>coercion!</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-default-failure-handler"><div class="inner"><span>default-failure-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-empty-type-repo"><div class="inner"><span>empty-type-repo</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-instance.3F"><div class="inner"><span>instance?</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-named"><div class="inner"><span>named</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-named.21"><div class="inner"><span>named!</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-set-failure-handler.21"><div class="inner"><span>set-failure-handler!</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-set-success-handler.21"><div class="inner"><span>set-success-handler!</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-start-over.21"><div class="inner"><span>start-over!</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-throwing-failure-handler"><div class="inner"><span>throwing-failure-handler</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">structural-typing.type</h2><div class="doc"><div class="markdown"><p>Structural types, loosely inspired by Elm&rsquo;s way of looking at <a href="http://elm-lang.org/learn/Records.elm">records</a>.</p></div></div><div class="public anchor" id="var-checked"><h3>checked</h3><div class="usage"><code>(checked type-repo name kvs)</code><code>(checked name kvs)</code></div><div class="doc"><div class="markdown"><p>Check the map <code>kvs</code> against the previously-defined type <code>name</code> in the given <code>type-repo</code>. If the <code>type-repo</code> is omitted, the global one is used.</p>
<pre><code>(type/checked :frobbish {:twerk true, :tweek false})
</code></pre><p>Types are defined with <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.type.html#var-named.21">named!</a>. By default, <code>checked</code> returns the <code>kvs</code> argument if it checks out, <code>nil</code> otherwise. Those defaults can be changed.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L81">view source</a></div></div><div class="public anchor" id="var-coerce"><h3>coerce</h3><div class="usage"><code>(coerce type-repo name kvs)</code><code>(coerce name kvs)</code></div><div class="doc"><div class="markdown"><p>Coerce the map or record <code>kvs</code> into the type named <code>name</code> in the <code>type-repo</code> and check the result with <a href="structural-typing.type.html#var-checked">checked</a>. The coerced version of <code>kvs</code> is returned.</p><p>If the type repo is omitted, the global type repo is used. Coercions are defined with <a href="structural-typing.type.html#var-coercion">coercion</a> or <a href="structural-typing.type.html#var-coercion.21">coercion!</a>.</p>
<pre><code> (some-&gt; (coerce :user-v2 legacy-json)
         (update-in [:stats :logins] inc))
</code></pre><p>If <code>name</code> hasn&rsquo;t been defined (via <a href="null">name</a> or <a href="structural-typing.type.html#var-named.21">named!</a>), the final call to <code>checked</code> is omitted.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L120">view source</a></div></div><div class="public anchor" id="var-coercion"><h3>coercion</h3><div class="usage"><code>(coercion type-repo name f)</code></div><div class="doc"><div class="markdown"><p>Register function <code>f</code> as one that can coerce a map or record into one that matches type <code>name</code>. The updated <code>type-repo</code> is returned. See also <a href="structural-typing.type.html#var-coercion.21">coercion!</a>, which updates the global type repo.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L112">view source</a></div></div><div class="public anchor" id="var-coercion.21"><h3>coercion!</h3><div class="usage"><code>(coercion! name f)</code></div><div class="doc"><div class="markdown"><p>Modify the global type repo to register function <code>f</code> as one that can coerce a map or record into one matching type <code>name</code>. See also <a href="structural-typing.type.html#var-coercion">coercion</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L193">view source</a></div></div><div class="public anchor" id="var-default-failure-handler"><h3>default-failure-handler</h3><div class="usage"><code>(default-failure-handler messages)</code></div><div class="doc"><div class="markdown"><p>This failure handler prints each error message on a separate line. It returns <code>nil</code>, allowing constructs like this:</p>
<pre><code> (some-&gt; (type/checked :frobnoz x)
         (assoc :goodness true)
         ...)
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L14">view source</a></div></div><div class="public anchor" id="var-empty-type-repo"><h3>empty-type-repo</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>A repository that contains no type descriptions. It contains default behavior for both success and failure cases. Here&rsquo;s an example of changing the behavior and adding a type:</p>
<pre><code>  (-&gt; type/empty-type-repo
      (assoc :failure-handler type/throwing-failure-handler)
      (type/named :frobable [:left :right :arrow]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L41">view source</a></div></div><div class="public anchor" id="var-instance.3F"><h3>instance?</h3><div class="usage"><code>(instance? type-repo name kvs)</code><code>(instance? name kvs)</code></div><div class="doc"><div class="markdown"><p>Return <code>true</code> iff the map or record <code>kvs</code> typechecks against the type named <code>name</code> in <code>type-repo</code>. If <code>type-repo</code> is omitted, the global repo is used.</p>
<pre><code>(type/instance? :frobbable kvs)
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L97">view source</a></div></div><div class="public anchor" id="var-named"><h3>named</h3><div class="usage"><code>(named type-repo name keys)</code></div><div class="doc"><div class="markdown"><p>Define the type <code>name</code> as being a map or record containing all of the given <code>keys</code>. Returns the augmented <code>type-repo</code>. See also <a href="structural-typing.type.html#var-named.21">named!</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L73">view source</a></div></div><div class="public anchor" id="var-named.21"><h3>named!</h3><div class="usage"><code>(named! name keys)</code></div><div class="doc"><div class="markdown"><p>Modifies the global type repo to define the type <code>name</code> as being a map or record containing all of the given <code>keys</code>. See also <a href="structural-typing.type.html#var-named">named</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L185">view source</a></div></div><div class="public anchor" id="var-set-failure-handler.21"><h3>set-failure-handler!</h3><div class="usage"><code>(set-failure-handler! f)</code></div><div class="doc"><div class="markdown"><p>Change the global type repo so that <code>f</code> is called when <a href="structural-typing.type.html#var-checked">checked</a> fails. <code>f</code> is given a list of error messages. <code>f</code>&rsquo;s return value becomes the return value of <code>checked</code>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L168">view source</a></div></div><div class="public anchor" id="var-set-success-handler.21"><h3>set-success-handler!</h3><div class="usage"><code>(set-success-handler! f)</code></div><div class="doc"><div class="markdown"><p>Change the global type repo so that <code>f</code> is called when <a href="structural-typing.type.html#var-checked">checked</a> succeeds. <code>f</code> is given the original map or record. <code>f</code>&rsquo;s return value becomes the return value of <code>checked</code>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L160">view source</a></div></div><div class="public anchor" id="var-start-over.21"><h3>start-over!</h3><div class="usage"><code>(start-over!)</code></div><div class="doc"><div class="markdown"><p>Reset the global type repo to its starting state: no types defined, and default handling of failure and success.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L153">view source</a></div></div><div class="public anchor" id="var-throwing-failure-handler"><h3>throwing-failure-handler</h3><div class="usage"><code>(throwing-failure-handler messages)</code></div><div class="doc"><div class="markdown"><p>In contrast to the default failure handler, this one throws a <code>java.lang.Exception</code> whose message is the concatenation of the type-mismatch messages.</p><p>To make all type mismatches throw failures, do this:</p>
<pre><code>   (type/set-failure-handler! type/throwing-failure-handler)
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L27">view source</a></div></div></div></body></html>