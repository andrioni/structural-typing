<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>structural-typing.type documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Structural-typing 0.12.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>structural-typing</span></div></div></li><li class="depth-2 branch"><a href="structural-typing.global-type.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>global-type</span></div></a></li><li class="depth-2 branch"><a href="structural-typing.preds.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>preds</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>surface</span></div></div></li><li class="depth-3 branch"><a href="structural-typing.surface.defaults.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>defaults</span></div></a></li><li class="depth-3 branch"><a href="structural-typing.surface.oopsie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oopsie</span></div></a></li><li class="depth-3"><a href="structural-typing.surface.type-repo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>type-repo</span></div></a></li><li class="depth-2 current"><a href="structural-typing.type.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>type</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="structural-typing.type.html#var-ALL"><div class="inner"><span>ALL</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-checked"><div class="inner"><span>checked</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-default-error-handler"><div class="inner"><span>default-error-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-default-success-handler"><div class="inner"><span>default-success-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-described-by.3F"><div class="inner"><span>described-by?</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-description"><div class="inner"><span>description</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-empty-type-repo"><div class="inner"><span>empty-type-repo</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-explain-with"><div class="inner"><span>explain-with</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-forks"><div class="inner"><span>forks</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-includes"><div class="inner"><span>includes</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-named"><div class="inner"><span>named</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-origin"><div class="inner"><span>origin</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-RANGE"><div class="inner"><span>RANGE</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-replace-error-handler"><div class="inner"><span>replace-error-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-replace-success-handler"><div class="inner"><span>replace-success-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-required-key"><div class="inner"><span>required-key</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-requires"><div class="inner"><span>requires</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-show-as"><div class="inner"><span>show-as</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-throwing-error-handler"><div class="inner"><span>throwing-error-handler</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">structural-typing.type</h2><div class="doc"><div class="markdown"><p>Structural types, loosely inspired by Elm&rsquo;s way of looking at <a href="http://elm-lang.org/learn/Records.elm">records</a>.</p></div></div><div class="public anchor" id="var-ALL"><h3>ALL</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Use this in a path to select all values of a collection.</p>
<pre><code>(type! :Figure {[:points ALL] (type/include :Point)})
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/paths/elements.clj#L13">view source</a></div></div><div class="public anchor" id="var-checked"><h3>checked</h3><div class="usage"><code>(checked type-repo type-signifier candidate)</code><code>(checked type-signifier candidate)</code></div><div class="doc"><div class="markdown"><p>Check the <code>candidate</code> collection against the previously-defined type named by <code>type-signifier</code> in the given <code>type-repo</code>. If the <code>type-repo</code> is omitted, the global one is used.</p>
<pre><code> (type/checked :Point {:x 1 :y 2})
</code></pre><p>To check if a candidate matches each of a set of types, wrap them in a vector:</p>
<pre><code> (type/checked [:Colorful :Point] {:x 1, :y 2, :color &quot;red&quot;})
</code></pre><p>Types are defined with <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.global-type.html#var-type.21">type!</a>. By default, <code>checked</code> returns  the <code>candidate</code> argument if it checks out, <code>nil</code> otherwise. Those defaults can be  changed (<a href="structural-typing.type.html#var-replace-success-handler">replace-success-handler</a>, <a href="structural-typing.type.html#var-replace-error-handler">replace-error-handler</a>, <a href="structural-typing.global-type.html#var-on-success.21">on-success!</a>, <a href="structural-typing.global-type.html#var-on-error.21">on-error!</a>). </p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L37">view source</a></div></div><div class="public anchor" id="var-default-error-handler"><h3>default-error-handler</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>This error handler takes the output of type checking (a sequence of <a href="structural-typing.surface.oopsie.html#var-oopsies">oopsies</a>) and prints each one&rsquo;s explanation to standard output. It returns <code>nil</code>, allowing constructs like this:</p>
<pre><code> (some-&gt; (type/checked :frobnoz x)
         (assoc :goodness true)
         ...)
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/surface/defaults.clj#L24">view source</a></div></div><div class="public anchor" id="var-default-success-handler"><h3>default-success-handler</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The default success handler just returns the original candidate structure passed to <code>checked</code>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/surface/defaults.clj#L20">view source</a></div></div><div class="public anchor" id="var-described-by.3F"><h3>described-by?</h3><div class="usage"><code>(described-by? type-repo type-signifier candidate)</code><code>(described-by? type-signifier candidate)</code></div><div class="doc"><div class="markdown"><p>Return <code>true</code> iff the <code>candidate</code> structure typechecks against the type named <code>type-signifier</code>. <code>type-signifier</code> may also be a vector of types, in which case the <code>candidate</code> must typecheck against each of them. </p><p>With three arguments, the check is against the <code>type-repo</code>. If <code>type-repo</code> is omitted, the global repo is used.</p>
<pre><code>(type/described-by? :Point candidate)
(type/described-by? [:Colorful :Point] candidate)
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L73">view source</a></div></div><div class="public anchor" id="var-description"><h3>description</h3><div class="usage"><code>(description type-repo type-signifier)</code><code>(description type-signifier)</code></div><div class="doc"><div class="markdown"><p>Returns the canonical (expanded) description of the <code>type-signifier</code>. Uses the global type repo if none is given. </p><p>The result is not a string, but rather a structure tweaked to look nice either at the repl or as the output from <code>pprint</code>. However, that means it&rsquo;s not a real type description; you can&rsquo;t feed it back to <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.global-type.html#var-type.21">type!</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L97">view source</a></div></div><div class="public anchor" id="var-empty-type-repo"><h3>empty-type-repo</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>A type repo that contains no types and uses the default success and error handlers.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/surface/type_repo.clj#L53">view source</a></div></div><div class="public anchor" id="var-explain-with"><h3>explain-with</h3><div class="usage"><code>(explain-with explainer predicate)</code></div><div class="doc"><div class="markdown"><p>After the <code>predicate</code> fails, the failure will need to be explained. Arrange for the <code>explainer</code> function to be called with the <a href="structural-typing.surface.oopsie.html#var-oopsie">oopsie</a> that results from the failure.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/annotated.clj#L41">view source</a></div></div><div class="public anchor" id="var-forks"><h3>forks</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>When writing a forking path, you may end up with vectors within vectors within  vectors. You can use <code>forks</code> instead of a vector to mark where the path  forks. </p>
<pre><code> (type! :Figure (type/requires [:a (forks :b1 :b2) :c]))
</code></pre><p><code>forks</code> is nothing but an alias for <code>vector</code>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/paths/readable.clj#L20">view source</a></div></div><div class="public anchor" id="var-includes"><h3>includes</h3><div class="usage"><code>(includes type-signifier)</code></div><div class="doc"><div class="markdown"><p>During creation of a type by <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.global-type.html#var-type.21">type!</a>, a call to <code>includes</code> is replaced with the type the <code>type-signifier</code> refers to. The exact meaning of that replacement depends on whether it&rsquo;s used in a path, as the value of a path, or as an entire argument itself. See the wiki documentation.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/paths/substituting.clj#L17">view source</a></div></div><div class="public anchor" id="var-named"><h3>named</h3><div class="usage"><code>(named type-repo type-signifier &amp; type-descriptions)</code></div><div class="doc"><div class="markdown"><p>Define the type <code>type-signifier</code> as being a map or record containing all of the  given <code>type-descriptions</code> (which may a vector of required keys or paths  or a (potentially nested) map from keys/paths to predicates or vectors of predicates.</p><p>Returns the augmented <code>type-repo</code>. See also <a href="null">named!</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L62">view source</a></div></div><div class="public anchor" id="var-origin"><h3>origin</h3><div class="usage"><code>(origin type-repo type-signifier)</code><code>(origin type-signifier)</code></div><div class="doc"><div class="markdown"><p>Returns the original description of the <code>type-signifier</code> (a sequence of vectors and maps). Uses the global type repo if none is given.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L89">view source</a></div></div><div class="public anchor" id="var-RANGE"><h3>RANGE</h3><div class="usage"><code>(RANGE inclusive-start exclusive-end)</code></div><div class="doc"><div class="markdown"><p>Use this in a path to select a range of values in a collection.</p>
<pre><code>(type! :SECOND-AND-THIRD-ARE-EVEN {[(RANGE 1 3)] even?})
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/paths/elements.clj#L23">view source</a></div></div><div class="public anchor" id="var-replace-error-handler"><h3>replace-error-handler</h3><div class="usage"><code>(replace-error-handler type-repo handler)</code></div><div class="doc"><div class="markdown"><p>For this <code>type-repo</code>, pass <a href="structural-typing.surface.oopsie.html#var-oopsies">oopsies</a> generated by type failures to <code>handler</code> as the last step in <a href="structural-typing.type.html#var-checked">checked</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L16">view source</a></div></div><div class="public anchor" id="var-replace-success-handler"><h3>replace-success-handler</h3><div class="usage"><code>(replace-success-handler type-repo handler)</code></div><div class="doc"><div class="markdown"><p>For this <code>type-repo</code>, handle candidates that typecheck successfully by passing them to <code>handler</code> as the last step in <a href="structural-typing.type.html#var-checked">checked</a>..</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L16">view source</a></div></div><div class="public anchor" id="var-required-key"><h3>required-key</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>False iff a key/path does not exist or has value <code>nil</code>. This is the only predicate that is not considered optional.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/required_key.clj#L22">view source</a></div></div><div class="public anchor" id="var-requires"><h3>requires</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Used to create an argument to <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.global-type.html#var-type.21">type!</a>. All of the elements are keys or paths that are required (as with <a href="structural-typing.type.html#var-required-key">required-key</a>) to be present in any matching candidate. This is exactly the same thing as putting the arguments in a vector.</p>
<pre><code>(type! :Figure (type/requires :color 
                              [:points ALL (type/include :Point)]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/paths/readable.clj#L9">view source</a></div></div><div class="public anchor" id="var-show-as"><h3>show-as</h3><div class="usage"><code>(show-as name predicate)</code></div><div class="doc"><div class="markdown"><p>Associate the given <code>name</code> string with the predicate for use when predicate failures are explained.</p>
<pre><code>  (-&gt;&gt; (partial &gt;= 3) (show-as &quot;less than 3&quot;))
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/annotated.clj#L28">view source</a></div></div><div class="public anchor" id="var-throwing-error-handler"><h3>throwing-error-handler</h3><div class="usage"><code>(throwing-error-handler oopsies)</code></div><div class="doc"><div class="markdown"><p>In contrast to the default error handler, this one throws a <code>java.lang.Exception</code> whose message is the concatenation of the <a href="structural-typing.surface.oopsie.html#var-explanations">explanations</a> of the <a href="structural-typing.surface.oopsie.html#var-oopsies">oopsies</a>.</p><p>To make all type mismatches throw failures, do this:</p>
<pre><code>   (global-type/on-error! type/throwing-failure-handler) ; for the global type repo
   (type/replace-error-handler type-repo type/throwing-failure-handler) ; local repo
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/surface/defaults.clj#L35">view source</a></div></div></div></body></html>